import{c as G,r as o,u as de,j as s,S as E,B as Ce,C as Pe,a as Me,b as Le,E as ze,T as We,d as Te}from"./chunk-D16GF57l.js";import{u as Fe,d as He,G as ne,P as De,O as ie,v as L,A as Ve,C as Oe,a as Ue,b as Ge,M as Qe,c as qe,e as _e,f as Ke,K as Je,g as Xe,h as Ze,p as $e,E as Ye,T as es}from"./chunk-DDrXY_bO.js";import"./mermaid-bundle.js";/**
 * @license lucide-react v0.518.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ss=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],ts=G("arrow-left",ss);/**
 * @license lucide-react v0.518.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const os=[["path",{d:"m11 17-5-5 5-5",key:"13zhaf"}],["path",{d:"m18 17-5-5 5-5",key:"h8a8et"}]],rs=G("chevrons-left",os);/**
 * @license lucide-react v0.518.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ns=[["path",{d:"m6 17 5-5-5-5",key:"xnjwq"}],["path",{d:"m13 17 5-5-5-5",key:"17xmmf"}]],is=G("chevrons-right",ns);/**
 * @license lucide-react v0.518.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const as=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],cs=G("external-link",as),ae=(i,c,b,A,S,d,u,v)=>{const h=y=>Ze(y,u??0,v??0);switch(c){case"launch":return i("chat:browser.actions.launched");case"click":return i("chat:browser.actions.clicked",{coordinate:b||h(A)});case"type":return i("chat:browser.actions.typed",{text:S});case"press":return i("chat:browser.actions.pressed",{key:$e(S)});case"scroll_down":return i("chat:browser.actions.scrolledDown");case"scroll_up":return i("chat:browser.actions.scrolledUp");case"hover":return i("chat:browser.actions.hovered",{coordinate:b||h(A)});case"resize":return i("chat:browser.actions.resized",{size:d==null?void 0:d.split(/[x,]/).join(" x ")});case"screenshot":return i("chat:browser.actions.screenshotSaved");case"close":return i("chat:browser.actions.closed");default:return c}},ce=i=>{switch(i){case"click":return s.jsx(Xe,{className:"w-4 h-4 opacity-80"});case"type":case"press":return s.jsx(Je,{className:"w-4 h-4 opacity-80"});case"scroll_down":return s.jsx(Ke,{className:"w-4 h-4 opacity-80"});case"scroll_up":return s.jsx(_e,{className:"w-4 h-4 opacity-80"});case"launch":return s.jsx(qe,{className:"w-4 h-4 opacity-80"});case"close":return s.jsx(Le,{className:"w-4 h-4 opacity-80"});case"resize":return s.jsx(Qe,{className:"w-4 h-4 opacity-80"});case"screenshot":return s.jsx(Ge,{className:"w-4 h-4 opacity-80"});case"hover":default:return s.jsx(Ue,{className:"w-4 h-4 opacity-80"})}},ls=o.memo(i=>{const{messages:c,isLast:b,onHeightChange:A,lastModifiedMessage:S,onExpandChange:d,fullScreen:u}=i,{t:v}=de(),h=o.useRef(0),[y,k]=o.useState(!1),[z,W]=o.useState(!1),[T,pe]=o.useState("all"),F=o.useRef(null),[ge,he]=o.useState(0),[xe,fe]=o.useState(0);o.useEffect(()=>{u&&W(!0)},[u]),o.useEffect(()=>{const e=F.current;if(!e)return;const t=()=>{const p=e.getBoundingClientRect();he(p.width),fe(p.height)};t();const n=typeof window<"u"&&"ResizeObserver"in window?new ResizeObserver(()=>t()):null;return n&&n.observe(e),()=>{n&&n.disconnect()}},[]);let K=i.browserViewportSizeProp||"900x600",J=i.isBrowserSessionActiveProp||!1;try{const e=Fe();K=e.browserViewportSize||"900x600",J=e.isBrowserSessionActive||!1}catch{}const[H,D]=K.split("x").map(Number),we=`${Math.round(H/2)},${Math.round(D/2)}`,V=o.useMemo(()=>{const e=[...c].reverse().find(n=>n.say==="api_req_started");if(e!=null&&e.text){const n=JSON.parse(e.text);if(n&&n.cancelReason!==null)return!0}return!!(b&&(S==null?void 0:S.ask)==="api_req_failed")},[c,S,b]),j=o.useMemo(()=>b&&c.some(e=>e.say==="browser_action_result")&&!V,[b,c,V]),r=o.useMemo(()=>{const e=[];return c.forEach(t=>{if(t.say==="browser_action")try{const n=JSON.parse(t.text||"{}"),p=c.find(a=>a.say==="browser_action_result"&&a.ts>t.ts&&a.text!=="");if(p){const a=JSON.parse(p.text||"{}");e.push({url:a.currentUrl,screenshot:a.screenshot,mousePosition:a.currentMousePosition,consoleLogs:a.logs,action:n,size:n.size,viewportWidth:a.viewportWidth,viewportHeight:a.viewportHeight})}else e.push({action:n,size:n.size})}catch{}}),e.length===0&&e.push({}),e},[c]),[l,R]=o.useState(0),B=o.useRef(!1),X=o.useRef(!1),O=o.useRef(0);o.useEffect(()=>{if(!X.current&&r.length>0){X.current=!0,R(r.length-1),O.current=r.length;return}r.length>O.current&&(l===O.current-1&&!B.current&&R(r.length-1),O.current=r.length)},[r.length,l]);const Z=o.useRef();o.useEffect(()=>{if(typeof i.navigateToPageIndex=="number"&&i.navigateToPageIndex!==Z.current&&r.length>0){const e=Math.max(0,Math.min(r.length-1,i.navigateToPageIndex));R(e),e===r.length-1&&(B.current=!1),Z.current=i.navigateToPageIndex}},[i.navigateToPageIndex]);const Q=o.useMemo(()=>{const e=c.find(t=>t.ask==="browser_action_launch");return(e==null?void 0:e.text)||""},[c]),f=r[l],N=o.useMemo(()=>{for(let e=r.length-1;e>=0;e--)if(r[e].screenshot)return r[e]},[r]),q=o.useMemo(()=>{for(let e=l;e>=0;e--)if(r[e].mousePosition)return r[e]},[r,l]),w={url:(f==null?void 0:f.url)||Q,mousePosition:(f==null?void 0:f.mousePosition)||(q==null?void 0:q.mousePosition)||we,consoleLogs:f==null?void 0:f.consoleLogs,screenshot:(f==null?void 0:f.screenshot)||(N==null?void 0:N.screenshot)},U=o.useMemo(()=>{const e={debug:0,info:0,warn:0,error:0,log:0},t={debug:[],info:[],warn:[],error:[],log:[]};return(w.consoleLogs||"").split(/\r?\n/).forEach(p=>{const a=p.trim();if(!a)return;const x=/^\[([^\]]+)\]\s*/i.exec(a);let g=((x==null?void 0:x[1])||"").toLowerCase();g==="warning"&&(g="warn"),["debug","info","warn","error","log"].includes(g)||(g="log"),e[g]++,t[g].push(p)}),{counts:e,byType:t}},[w.consoleLogs]),be=o.useMemo(()=>{if(!w.consoleLogs)return v("chat:browser.noNewLogs");if(T==="all")return w.consoleLogs;const e=U.byType[T];return e.length?e.join(`
`):v("chat:browser.noNewLogs")},[w.consoleLogs,T,U,v]),ve=[{key:"all",label:"All"},{key:"debug",label:"Debug"},{key:"info",label:"Info"},{key:"warn",label:"Warn"},{key:"error",label:"Error"},{key:"log",label:"Log"}],me=600/900*100;let C,P;f!=null&&f.screenshot?(C=f.viewportWidth??H,P=f.viewportHeight??D):N?(C=N.viewportWidth??H,P=N.viewportHeight??D):(C=H,P=D);const Ae=o.useMemo(()=>{var e;return(e=r[l])==null?void 0:e.action},[r,l]),_=o.useMemo(()=>c.filter(t=>t.say==="browser_action").at(-1),[c]),$=J,ye=o.useMemo(()=>{if(!_||V)return!1;const e=[...c].reverse().find(t=>t.say==="browser_action_result");return e?_.ts>e.ts:!0},[c,_,V]),Y=o.useMemo(()=>{let e=0;return c.forEach(t=>{if(t.say==="api_req_started"&&t.text)try{const n=JSON.parse(t.text);n.cost&&typeof n.cost=="number"&&(e+=n.cost)}catch{}}),e},[c]),ee=o.useRef(null),[I,je]=o.useState(0);o.useEffect(()=>{const e=ee.current;if(!e)return;let t=!0;const n=a=>{t&&je(a)},p=typeof window<"u"&&"ResizeObserver"in window?new ResizeObserver(a=>{var g;const x=a[0];n(((g=x==null?void 0:x.contentRect)==null?void 0:g.height)??e.getBoundingClientRect().height)}):null;return n(e.getBoundingClientRect().height),p&&p.observe(e),()=>{t=!1,p&&p.disconnect()}},[]);const Se=()=>s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:0,userSelect:"none"},children:[s.jsx(ne,{className:"w-4 h-4 shrink-0",style:{opacity:.7,color:$?"#4ade80":void 0,cursor:u?"default":"pointer"},"aria-label":"Browser interaction",...u?{}:{onClick:()=>W(e=>{const t=!e;return d==null||d(t),t})}}),s.jsxs("span",{...u?{}:{onClick:()=>W(e=>{const t=!e;return d==null||d(t),t})},style:{flex:1,fontSize:13,fontWeight:500,lineHeight:"22px",color:"var(--vscode-editor-foreground)",cursor:u?"default":"pointer",display:"flex",alignItems:"center",gap:8},children:[v("chat:browser.session"),ye&&s.jsx("span",{className:"ml-1 flex items-center","aria-hidden":"true",children:s.jsx(De,{})}),r.length>0&&s.jsxs("span",{style:{fontSize:11,opacity:.6,fontWeight:400},children:[l+1,"/",r.length]}),s.jsx("span",{style:{display:"inline-flex",alignItems:"center",gap:6,fontSize:12,color:"var(--vscode-descriptionForeground)",fontWeight:400},children:(()=>{var a,x,g;const e=Ae,t=(a=r[l])==null?void 0:a.size,n=(x=r[l])==null?void 0:x.viewportWidth,p=(g=r[l])==null?void 0:g.viewportHeight;return e?s.jsxs(s.Fragment,{children:[ce(e.action),s.jsx("span",{children:ae(v,e.action,e.executedCoordinate,e.coordinate,e.text,t,n,p)})]}):Q?s.jsxs(s.Fragment,{children:[ce("launch"),s.jsx("span",{children:ae(v,"launch",void 0,Q,void 0)})]}):null})()})]}),Y>0&&s.jsxs("div",{className:"text-xs text-vscode-dropdown-foreground border-vscode-dropdown-border/50 border px-1.5 py-0.5 rounded-lg",style:{opacity:.4,height:"22px",display:"flex",alignItems:"center"},children:["$",Y.toFixed(4)]}),!u&&s.jsx("span",{onClick:()=>W(e=>{const t=!e;return d==null||d(t),t}),className:`codicon ${z?"codicon-chevron-up":"codicon-chevron-down"}`,style:{fontSize:13,fontWeight:500,lineHeight:"22px",color:"var(--vscode-editor-foreground)",cursor:"pointer",display:"inline-block",transition:"transform 150ms ease"}}),$&&!u&&s.jsx(E,{content:"Disconnect session",children:s.jsx(Ce,{variant:"ghost",size:"icon",onClick:e=>{e.stopPropagation(),L.postMessage({type:"killBrowserSession"})},"aria-label":"Disconnect session",children:s.jsx(ie,{className:"size-4"})})})]}),ke=()=>z?s.jsxs("div",{style:{marginTop:u?0:6,background:"var(--vscode-editor-background)",border:"1px solid var(--vscode-panel-border)",borderRadius:u?0:6,overflow:"hidden",height:u?"100%":void 0,display:u?"flex":void 0,flexDirection:u?"column":void 0},children:[s.jsxs("div",{style:{padding:"6px 8px",display:"flex",alignItems:"center",gap:"8px",borderBottom:"1px solid var(--vscode-panel-border)",background:"var(--vscode-editor-background)"},children:[s.jsx(E,{content:"Go to beginning",children:s.jsx("button",{onClick:e=>{e.stopPropagation(),B.current=!0,R(0)},disabled:l===0||j,style:{background:"none",border:"1px solid var(--vscode-panel-border)",borderRadius:4,cursor:l===0||j?"not-allowed":"pointer",opacity:l===0||j?.4:.85,padding:"4px",display:"flex",alignItems:"center",color:"var(--vscode-foreground)"},"aria-label":"Go to beginning",children:s.jsx(rs,{className:"w-4 h-4"})})}),s.jsx(E,{content:"Back",children:s.jsx("button",{onClick:e=>{e.stopPropagation(),B.current=!0,R(t=>Math.max(0,t-1))},disabled:l===0||j,style:{background:"none",border:"1px solid var(--vscode-panel-border)",borderRadius:4,cursor:l===0||j?"not-allowed":"pointer",opacity:l===0||j?.4:.85,padding:"4px",display:"flex",alignItems:"center",color:"var(--vscode-foreground)"},"aria-label":"Back",children:s.jsx(ts,{className:"w-4 h-4"})})}),s.jsx(E,{content:"Forward",children:s.jsx("button",{onClick:e=>{e.stopPropagation();const t=Math.min(r.length-1,l+1);B.current=t!==r.length-1,R(t)},disabled:l===r.length-1||j,style:{background:"none",border:"1px solid var(--vscode-panel-border)",borderRadius:4,cursor:l===r.length-1||j?"not-allowed":"pointer",opacity:l===r.length-1||j?.4:.85,padding:"4px",display:"flex",alignItems:"center",color:"var(--vscode-foreground)"},"aria-label":"Forward",children:s.jsx(Ve,{className:"w-4 h-4"})})}),s.jsx(E,{content:"Go to end",children:s.jsx("button",{onClick:e=>{e.stopPropagation(),B.current=!1,R(r.length-1)},disabled:l===r.length-1||j,style:{background:"none",border:"1px solid var(--vscode-panel-border)",borderRadius:4,cursor:l===r.length-1||j?"not-allowed":"pointer",opacity:l===r.length-1||j?.4:.85,padding:"4px",display:"flex",alignItems:"center",color:"var(--vscode-foreground)"},"aria-label":"Go to end",children:s.jsx(is,{className:"w-4 h-4"})})}),s.jsxs("div",{role:"group","aria-label":"Address bar",style:{flex:1,display:"flex",alignItems:"center",gap:8,border:"1px solid var(--vscode-panel-border)",borderRadius:999,padding:"4px 10px",background:"var(--vscode-input-background)",color:"var(--vscode-descriptionForeground)",minHeight:26,overflow:"hidden"},children:[s.jsx(ne,{className:"w-3 h-3 shrink-0 opacity-60"}),s.jsx("span",{style:{fontSize:12,lineHeight:"18px",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",color:"var(--vscode-foreground)"},children:w.url||"about:blank"})]}),s.jsx(E,{content:"Disconnect session",children:s.jsx("button",{onClick:e=>{e.stopPropagation(),L.postMessage({type:"killBrowserSession"})},style:{background:"none",border:"1px solid var(--vscode-panel-border)",borderRadius:4,cursor:"pointer",opacity:.85,padding:"4px",display:"flex",alignItems:"center",color:"var(--vscode-foreground)"},"aria-label":"Disconnect session",children:s.jsx(ie,{className:"w-4 h-4"})})}),s.jsx(E,{content:"Open in external browser",children:s.jsx("button",{onClick:e=>{e.stopPropagation(),w.url&&L.postMessage({type:"openExternal",url:w.url})},style:{background:"none",border:"1px solid var(--vscode-panel-border)",borderRadius:4,cursor:w.url?"pointer":"not-allowed",opacity:w.url?.85:.4,padding:"4px",display:"flex",alignItems:"center",color:"var(--vscode-foreground)"},"aria-label":"Open external",disabled:!w.url,children:s.jsx(cs,{className:"w-4 h-4"})})}),s.jsx(E,{content:"Copy URL",children:s.jsx("button",{onClick:async e=>{e.stopPropagation();try{await navigator.clipboard.writeText(w.url||"")}catch{}},style:{background:"none",border:"1px solid var(--vscode-panel-border)",borderRadius:4,cursor:"pointer",opacity:.85,padding:"4px",display:"flex",alignItems:"center",color:"var(--vscode-foreground)"},"aria-label":"Copy URL",children:s.jsx(Pe,{className:"w-4 h-4"})})})]}),s.jsxs("div",{"data-testid":"screenshot-container",ref:F,style:{width:"100%",position:"relative",backgroundColor:"var(--vscode-input-background)",borderBottom:"1px solid var(--vscode-panel-border)",...u?{flex:1,minHeight:0}:{paddingBottom:`${me.toFixed(2)}%`}},children:[w.screenshot?s.jsx("img",{src:w.screenshot,alt:v("chat:browser.screenshot"),style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",objectFit:"contain",objectPosition:"top center",cursor:"pointer"},onClick:()=>L.postMessage({type:"openImage",text:w.screenshot})}):s.jsx("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"},children:s.jsx("span",{className:"codicon codicon-globe",style:{fontSize:"80px",color:"var(--vscode-descriptionForeground)"}})}),w.mousePosition&&(()=>{var oe,re;const e=ge||(((oe=F.current)==null?void 0:oe.clientWidth)??0),t=xe||(((re=F.current)==null?void 0:re.clientHeight)??0);if(e<=0||t<=0)return s.jsx(le,{style:{position:"absolute",top:"0px",left:"0px",zIndex:2,pointerEvents:"none"}});const n=C/P,p=e/t;let a=e,x=t,g=0,M=0;p>n?(x=t,a=t*n,g=(e-a)/2,M=0):(a=e,x=e/n,g=0,M=0);const m=/^\s*(\d+)\s*,\s*(\d+)(?:\s*@\s*(\d+)\s*[x,]\s*(\d+))?\s*$/.exec(w.mousePosition||""),Re=parseInt((m==null?void 0:m[1])||"0",10),Be=parseInt((m==null?void 0:m[2])||"0",10),se=m!=null&&m[3]?parseInt(m[3],10):C,te=m!=null&&m[4]?parseInt(m[4],10):P,Ne=g+(se>0?Re/se*a:0),Ie=M+(te>0?Be/te*x:0);return s.jsx(le,{style:{position:"absolute",top:`${Ie}px`,left:`${Ne}px`,zIndex:2,pointerEvents:"none",transition:"top 0.15s ease-out, left 0.15s ease-out"}})})()]}),s.jsxs("div",{style:{padding:"8px 10px",marginTop:u?"auto":void 0},children:[s.jsxs("div",{onClick:e=>{e.stopPropagation(),k(t=>!t)},className:"text-vscode-editor-foreground/70 hover:text-vscode-editor-foreground transition-colors",style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:y?"6px":0,cursor:"pointer"},children:[s.jsx(Me,{className:"w-3"}),s.jsx("span",{className:"text-xs",style:{fontWeight:500},children:v("chat:browser.consoleLogs")}),s.jsxs("div",{onClick:e=>e.stopPropagation(),style:{display:"flex",alignItems:"center",gap:6,marginLeft:"auto"},children:[ve.map(({key:e,label:t})=>{const n=e==="all",p=n?Object.values(U.counts).reduce((g,M)=>g+M,0):U.counts[e],a=T===e,x=p===0;return s.jsxs("button",{onClick:()=>{k(!0),pe(n?"all":g=>g===e?"all":e)},disabled:x,title:`${t}: ${p}`,style:{border:"1px solid var(--vscode-panel-border)",borderRadius:999,padding:"0 6px",height:18,lineHeight:"16px",fontSize:10,color:"var(--vscode-foreground)",background:a?"var(--vscode-editor-selectionBackground)":"transparent",opacity:x?.35:.85,cursor:x?"not-allowed":"pointer"},children:[t,": ",p]},e)}),s.jsx("span",{onClick:()=>k(e=>!e),className:`codicon codicon-chevron-${y?"down":"right"}`,style:{marginLeft:6}})]})]}),y&&s.jsx("div",{style:{marginTop:"6px"},children:s.jsx(Oe,{source:be,language:"shell"})})]})]}):null,Ee=s.jsxs("div",{ref:ee,style:{padding:"6px 10px",background:"var(--vscode-editor-background,transparent)",height:"100%"},children:[s.jsx(Se,{}),s.jsx(ke,{})]});return o.useEffect(()=>{const e=h.current===0;b&&I!==0&&I!==1/0&&I!==h.current&&(e||A==null||A(I>h.current),h.current=I)},[I,b,A]),Ee},He),le=({style:i})=>{const{t:c}=de();return s.jsx("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAYCAYAAAAVibZIAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFaADAAQAAAABAAAAGAAAAADwi9a/AAADGElEQVQ4EZ2VbUiTURTH772be/PxZdsz3cZwC4RVaB8SAjMpxQwSWZbQG/TFkN7oW1Df+h6IRV9C+hCpKUSIZUXOfGM5tAKViijFFEyfZ7Ol29S1Pbdzl8Uw9+aBu91zzv3/nt17zt2DEZjBYOAkKrtFMXIghAWM8U2vMN/FctsxGRMpM7NbEEYNMM2CYUSInlJx3OpawO9i+XSNQYkmk2uFb9njzkcfVSr1p/GJiQKMULVaw2WuBv296UKRxWJR6wxGCmM1EAhSNppv33GBH9qI32cPTAtss9lUm6EM3N7R+RbigT+5/CeosFCZKpjEW+iorS1pb30wDUXzQfHqtD/9L3ieZ2ee1OJCmbL8QHnRs+4uj0wmW4QzrpCwvJ8zGg3JqAmhTLynuLiwv8/5KyND8Q3cEkUEDWu15oJE4KRQJt5hs1rcriGNRqP+DK4dyyWXXm/aFQ+cEpSJ8/LyDGPuEZNOmzsOroUSOqzXG/dtBU4ZysTZYKNut91sNo2Cq6cE9enz86s2g9OCMrFSqVC5hgb32u072W3jKMU90Hb1seC0oUwsB+t92bO/rKx0EFGkgFCnjjc1/gVvC8rE0L+4o63t4InjxwbAJQjTe3qD8QrLkXA4DC24fWtuajp06cLFYSBIFKGmXKPRRmAnME9sPt+yLwIWb9WN69fKoTneQz4Dh2mpPNkvfeV0jjecb9wNAkwIEVQq5VJOds4Kb+DXoAsiVquVwI1Dougpij6UyGYx+5cKroeDEFibm5lWRRMbH1+npmYrq6qhwlQHIbajZEf1fElcqGGFpGg9HMuKzpfBjhytCTMgkJ56RX09zy/ysENTBElmjIgJnmNChJqohDVQqpEfwkILE8v/o0GAnV9F1eEvofVQCbiTBEXOIPQh5PGgefDZeAcjrpGZjULBr/m3tZOnz7oEQWRAQZLjWlEU/XEJWySiILgRc5Cz1DkcAyuBFcnpfF0JiXWKpcolQXizhS5hKAqFpr0MVbgbuxJ6+5xX+P4wNpbqPPrugZfbmIbLmgQR3Aw8QSi66hUXulOFbF73GxqjE5BNXWNeAAAAAElFTkSuQmCC",style:{width:"17px",height:"22px",...i},alt:c("chat:browser.cursor"),"aria-label":c("chat:browser.cursor")})},ue=o.createContext(void 0),ds=({children:i})=>{const[c,b]=o.useState({browserViewportSize:"900x600",isBrowserSessionActive:!1,language:"en"}),A=o.useCallback(S=>{const d=S.data;switch(d.type){case"state":d.state&&b(u=>{var v,h,y;return{...u,browserViewportSize:((v=d.state)==null?void 0:v.browserViewportSize)||"900x600",isBrowserSessionActive:((h=d.state)==null?void 0:h.isBrowserSessionActive)||!1,language:((y=d.state)==null?void 0:y.language)||"en"}});break;case"browserSessionUpdate":d.isBrowserSessionActive!==void 0&&b(u=>({...u,isBrowserSessionActive:d.isBrowserSessionActive||!1}));break}},[]);return o.useEffect(()=>(window.addEventListener("message",A),()=>{window.removeEventListener("message",A)}),[A]),s.jsx(ue.Provider,{value:c,children:i})},us=()=>{const i=o.useContext(ue);if(i===void 0)throw new Error("useBrowserPanelState must be used within a BrowserPanelStateProvider");return i},ps=()=>{const{browserViewportSize:i,isBrowserSessionActive:c}=us(),[b,A]=o.useState({messages:[]}),[S,d]=o.useState(void 0),[u,v]=o.useState({});return o.useEffect(()=>{const h=y=>{const k=y.data;switch(k.type){case"browserSessionUpdate":k.browserSessionMessages&&A(z=>({...z,messages:k.browserSessionMessages||[]}));break;case"browserSessionNavigate":typeof k.stepIndex=="number"&&k.stepIndex>=0&&d(k.stepIndex);break}};return window.addEventListener("message",h),()=>{window.removeEventListener("message",h)}},[]),s.jsx("div",{className:"fixed top-0 left-0 right-0 bottom-0 flex flex-col overflow-hidden bg-vscode-editor-background",children:s.jsx(ls,{messages:b.messages,isLast:!0,lastModifiedMessage:b.messages.at(-1),isStreaming:!1,isExpanded:h=>u[h]??!1,onToggleExpand:h=>{v(y=>({...y,[h]:!y[h]}))},fullScreen:!0,browserViewportSizeProp:i,isBrowserSessionActiveProp:c,navigateToPageIndex:S})})},gs=()=>(o.useEffect(()=>{try{L.postMessage({type:"webviewDidLaunch"})}catch{}},[]),s.jsx(ze,{children:s.jsx(Ye,{children:s.jsx(We,{children:s.jsx(es,{children:s.jsx(ds,{children:s.jsx(ps,{})})})})})}));Te.createRoot(document.getElementById("root")).render(s.jsx(o.StrictMode,{children:s.jsx(gs,{})}));
//# sourceMappingURL=browser-panel.js.map
