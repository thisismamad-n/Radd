/**
 * RTL (Right-to-Left) Support for Persian/Farsi
 * پشتیبانی از راست به چپ برای زبان فارسی
 * 
 * Vazirmatn Font: https://github.com/rastikerdar/vazirmatn
 * A Persian/Arabic font optimized for screen display
 */

/* Vazirmatn Font - Google Fonts CDN */
@import url('https://fonts.googleapis.com/css2?family=Vazirmatn:wght@100;200;300;400;500;600;700;800;900&display=swap');

/* Fallback font-face for offline use */
@font-face {
  font-family: 'Vazirmatn';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Vazirmatn'), local('Vazirmatn-Regular');
}

@font-face {
  font-family: 'Vazirmatn';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Vazirmatn Bold'), local('Vazirmatn-Bold');
}

/* CSS Custom Properties for Persian Typography */
:root {
  --font-family-persian: 'Vazirmatn', 'Tahoma', 'Arial', sans-serif;
  --font-family-mono-persian: 'Vazirmatn', 'Consolas', 'Courier New', monospace;
  --line-height-persian: 1.8;
  --letter-spacing-persian: 0.01em;
}

/* RTL Base Styles */
[dir="rtl"],
.rtl {
  direction: rtl;
  text-align: right;
}

/* RTL for specific elements */
[dir="rtl"] .chat-input,
[dir="rtl"] .message-content,
[dir="rtl"] .task-description,
[dir="rtl"] textarea,
[dir="rtl"] input[type="text"] {
  direction: rtl;
  text-align: right;
}

/* Preserve LTR for code blocks */
[dir="rtl"] pre,
[dir="rtl"] code,
[dir="rtl"] .code-block,
[dir="rtl"] .hljs,
[dir="rtl"] .monaco-editor {
  direction: ltr;
  text-align: left;
}

/* RTL Flexbox adjustments */
[dir="rtl"] .flex-row {
  flex-direction: row-reverse;
}

/* RTL Icon positioning */
[dir="rtl"] .icon-left {
  margin-left: 0.5rem;
  margin-right: 0;
}

[dir="rtl"] .icon-right {
  margin-right: 0.5rem;
  margin-left: 0;
}

/* RTL Button groups */
[dir="rtl"] .button-group {
  flex-direction: row-reverse;
}

/* RTL List items */
[dir="rtl"] ul,
[dir="rtl"] ol {
  padding-right: 1.5rem;
  padding-left: 0;
}

/* RTL Sidebar */
[dir="rtl"] .sidebar {
  border-left: 1px solid var(--vscode-panel-border);
  border-right: none;
}

/* RTL Chat messages */
[dir="rtl"] .message-user {
  margin-left: 0;
  margin-right: auto;
}

[dir="rtl"] .message-assistant {
  margin-right: 0;
  margin-left: auto;
}

/* RTL Tooltips */
[dir="rtl"] .tooltip {
  text-align: right;
}

/* RTL Form labels */
[dir="rtl"] label {
  text-align: right;
}

/* RTL Select dropdowns */
[dir="rtl"] select {
  text-align: right;
  padding-right: 0.5rem;
  padding-left: 1.5rem;
}

/* RTL Checkboxes and radios */
[dir="rtl"] input[type="checkbox"],
[dir="rtl"] input[type="radio"] {
  margin-left: 0.5rem;
  margin-right: 0;
}

/* RTL Progress bars */
[dir="rtl"] .progress-bar {
  direction: rtl;
}

/* RTL Breadcrumbs */
[dir="rtl"] .breadcrumb-separator {
  transform: scaleX(-1);
}

/* RTL Navigation arrows */
[dir="rtl"] .nav-arrow-left {
  transform: scaleX(-1);
}

[dir="rtl"] .nav-arrow-right {
  transform: scaleX(-1);
}

/* RTL Tables */
[dir="rtl"] table {
  direction: rtl;
}

[dir="rtl"] th,
[dir="rtl"] td {
  text-align: right;
}

/* RTL Scrollbars (for browsers that support it) */
[dir="rtl"]::-webkit-scrollbar {
  direction: rtl;
}

/* Persian/Farsi specific font settings */
[lang="fa"],
[dir="rtl"] {
  font-family: var(--font-family-persian, 'Vazirmatn', 'Tahoma', 'Arial', sans-serif);
  line-height: var(--line-height-persian, 1.8);
  letter-spacing: var(--letter-spacing-persian, 0.01em);
}

/* Persian text in specific elements */
[dir="rtl"] h1,
[dir="rtl"] h2,
[dir="rtl"] h3,
[dir="rtl"] h4,
[dir="rtl"] h5,
[dir="rtl"] h6 {
  font-family: var(--font-family-persian);
  font-weight: 700;
}

[dir="rtl"] p,
[dir="rtl"] span,
[dir="rtl"] div {
  font-family: var(--font-family-persian);
}

/* Monospace Persian font for code-adjacent text */
[dir="rtl"] .mono-persian {
  font-family: var(--font-family-mono-persian);
}

/* Ensure numbers display correctly in RTL */
[dir="rtl"] .number,
[dir="rtl"] .price,
[dir="rtl"] .date {
  direction: ltr;
  display: inline-block;
}

/* ===== BIDIRECTIONAL TEXT HANDLING ===== */
/* Fix mixed Persian/English text display */

/* Use Unicode Bidi Isolate for proper text direction */
[dir="rtl"] {
  unicode-bidi: isolate;
}

/* Isolate English/LTR content within RTL context */
[dir="rtl"] .ltr-content,
[dir="rtl"] [lang="en"],
[dir="rtl"] .english-text {
  direction: ltr;
  unicode-bidi: isolate;
  display: inline-block;
}

/* Embed LTR content properly in RTL flow */
[dir="rtl"] .embed-ltr {
  direction: ltr;
  unicode-bidi: embed;
}

/* Force RTL for Persian text that might be affected by LTR content */
[dir="rtl"] .force-rtl,
[dir="rtl"] [lang="fa"] {
  direction: rtl;
  unicode-bidi: isolate-override;
}

/* Handle file paths, URLs, and technical strings */
[dir="rtl"] .file-path,
[dir="rtl"] .url,
[dir="rtl"] .technical-string,
[dir="rtl"] .command-text {
  direction: ltr;
  unicode-bidi: isolate;
  display: inline-block;
  text-align: left;
}

/* Handle mixed content in messages */
[dir="rtl"] .message-content {
  unicode-bidi: plaintext;
}

/* Proper handling of inline code in RTL */
[dir="rtl"] code:not(pre code),
[dir="rtl"] .inline-code {
  direction: ltr;
  unicode-bidi: isolate;
  display: inline-block;
}

/* Handle variable names, function names, etc. */
[dir="rtl"] .identifier,
[dir="rtl"] .variable-name,
[dir="rtl"] .function-name {
  direction: ltr;
  unicode-bidi: isolate;
  display: inline-block;
}

/* Handle keyboard shortcuts */
[dir="rtl"] kbd,
[dir="rtl"] .keyboard-shortcut {
  direction: ltr;
  unicode-bidi: isolate;
}

/* Handle version numbers and technical identifiers */
[dir="rtl"] .version,
[dir="rtl"] .model-name,
[dir="rtl"] .api-key {
  direction: ltr;
  unicode-bidi: isolate;
  display: inline-block;
}

/* Handle error messages that may contain English */
[dir="rtl"] .error-message,
[dir="rtl"] .warning-message {
  unicode-bidi: plaintext;
}

/* Handle labels with mixed content */
[dir="rtl"] label {
  unicode-bidi: plaintext;
}

/* Handle button text with icons */
[dir="rtl"] button {
  unicode-bidi: plaintext;
}

/* Handle dropdown options */
[dir="rtl"] option,
[dir="rtl"] .dropdown-item {
  unicode-bidi: plaintext;
}

/* Handle list items with mixed content */
[dir="rtl"] li {
  unicode-bidi: plaintext;
}

/* Handle headings with mixed content */
[dir="rtl"] h1,
[dir="rtl"] h2,
[dir="rtl"] h3,
[dir="rtl"] h4,
[dir="rtl"] h5,
[dir="rtl"] h6 {
  unicode-bidi: plaintext;
}

/* Handle paragraphs with mixed content */
[dir="rtl"] p {
  unicode-bidi: plaintext;
}

/* Handle spans that might contain mixed content */
[dir="rtl"] span {
  unicode-bidi: plaintext;
}

/* Handle divs that might contain mixed content */
[dir="rtl"] div {
  unicode-bidi: plaintext;
}

/* RTL Modal dialogs */
[dir="rtl"] .modal-header {
  flex-direction: row-reverse;
}

[dir="rtl"] .modal-close {
  left: 1rem;
  right: auto;
}

/* RTL Search input */
[dir="rtl"] .search-input {
  padding-right: 2.5rem;
  padding-left: 0.75rem;
}

[dir="rtl"] .search-icon {
  right: 0.75rem;
  left: auto;
}

/* RTL Tabs */
[dir="rtl"] .tabs {
  flex-direction: row-reverse;
}

/* RTL Activity bar */
[dir="rtl"] .activity-bar {
  border-left: 1px solid var(--vscode-activityBar-border);
  border-right: none;
}

/* RTL Status bar */
[dir="rtl"] .status-bar {
  flex-direction: row-reverse;
}

/* RTL Tree view */
[dir="rtl"] .tree-item {
  padding-right: calc(var(--indent-level, 0) * 1rem);
  padding-left: 0;
}

[dir="rtl"] .tree-item-icon {
  margin-left: 0.5rem;
  margin-right: 0;
}

/* RTL Notifications */
[dir="rtl"] .notification {
  text-align: right;
}

[dir="rtl"] .notification-icon {
  margin-left: 0.75rem;
  margin-right: 0;
}

/* RTL Command palette */
[dir="rtl"] .command-palette-input {
  text-align: right;
}

/* RTL Quick pick */
[dir="rtl"] .quick-pick-item {
  flex-direction: row-reverse;
}

/* RTL Settings */
[dir="rtl"] .setting-item {
  text-align: right;
}

[dir="rtl"] .setting-item-description {
  text-align: right;
}


/* ===== ADDITIONAL RTL FIXES FOR COMMON PATTERNS ===== */

/* Fix chat input area */
[dir="rtl"] .chat-input-container {
  direction: rtl;
}

[dir="rtl"] .chat-input-container textarea {
  text-align: right;
  unicode-bidi: plaintext;
}

/* Fix message bubbles alignment */
[dir="rtl"] .message-bubble {
  unicode-bidi: plaintext;
}

/* Fix toolbar buttons order */
[dir="rtl"] .toolbar {
  flex-direction: row-reverse;
}

/* Fix action buttons */
[dir="rtl"] .action-buttons {
  flex-direction: row-reverse;
}

/* Fix menu items */
[dir="rtl"] .menu-item {
  flex-direction: row-reverse;
  text-align: right;
}

[dir="rtl"] .menu-item-icon {
  margin-left: 0.5rem;
  margin-right: 0;
}

/* Fix badges positioning */
[dir="rtl"] .badge {
  margin-left: 0;
  margin-right: 0.25rem;
}

/* Fix close buttons */
[dir="rtl"] .close-button {
  left: 0.5rem;
  right: auto;
}

/* Fix expand/collapse icons */
[dir="rtl"] .expand-icon,
[dir="rtl"] .collapse-icon {
  transform: scaleX(-1);
}

/* Fix chevron icons */
[dir="rtl"] .chevron-right {
  transform: scaleX(-1);
}

[dir="rtl"] .chevron-left {
  transform: scaleX(-1);
}

/* Fix file tree indentation */
[dir="rtl"] .file-tree-item {
  padding-right: calc(var(--depth, 0) * 1rem);
  padding-left: 0;
}

/* Fix code diff view - keep LTR */
[dir="rtl"] .diff-view,
[dir="rtl"] .diff-content {
  direction: ltr;
  text-align: left;
}

/* Fix terminal output - keep LTR */
[dir="rtl"] .terminal-output,
[dir="rtl"] .command-output {
  direction: ltr;
  text-align: left;
  font-family: var(--vscode-editor-font-family), monospace;
}

/* Fix JSON/code display */
[dir="rtl"] .json-view,
[dir="rtl"] .code-view {
  direction: ltr;
  text-align: left;
}

/* Fix placeholder text */
[dir="rtl"] input::placeholder,
[dir="rtl"] textarea::placeholder {
  text-align: right;
}

/* Fix autocomplete dropdown */
[dir="rtl"] .autocomplete-dropdown {
  text-align: right;
}

/* Fix context menu */
[dir="rtl"] .context-menu {
  text-align: right;
}

[dir="rtl"] .context-menu-item {
  flex-direction: row-reverse;
}

/* Fix toast notifications */
[dir="rtl"] .toast {
  text-align: right;
}

[dir="rtl"] .toast-icon {
  margin-left: 0.5rem;
  margin-right: 0;
}

/* Fix loading spinners - don't flip */
[dir="rtl"] .spinner,
[dir="rtl"] .loading-indicator {
  /* Keep spinner animation direction - no transform needed */
  transform: none;
}

/* Fix progress bars */
[dir="rtl"] .progress-bar-fill {
  transform-origin: right;
}

/* Fix slider controls */
[dir="rtl"] input[type="range"] {
  direction: rtl;
}

/* Fix switch/toggle controls */
[dir="rtl"] .switch,
[dir="rtl"] .toggle {
  flex-direction: row-reverse;
}

/* Fix avatar positioning in messages */
[dir="rtl"] .message-avatar {
  margin-left: 0.5rem;
  margin-right: 0;
}

/* Fix timestamp positioning */
[dir="rtl"] .message-timestamp {
  text-align: left;
}

/* Fix token/cost display - numbers should be LTR */
[dir="rtl"] .token-count,
[dir="rtl"] .cost-display {
  direction: ltr;
  unicode-bidi: isolate;
  display: inline-block;
}

/* Fix model selector */
[dir="rtl"] .model-selector {
  text-align: right;
}

[dir="rtl"] .model-selector .model-name {
  direction: ltr;
  unicode-bidi: isolate;
}

/* Fix settings labels */
[dir="rtl"] .setting-label {
  text-align: right;
}

[dir="rtl"] .setting-description {
  text-align: right;
}

/* Fix API configuration display */
[dir="rtl"] .api-config {
  text-align: right;
}

[dir="rtl"] .api-config .api-key,
[dir="rtl"] .api-config .api-url {
  direction: ltr;
  unicode-bidi: isolate;
  text-align: left;
}
